# 图像水印嵌入与提取实验报告

## 一、实验目的

本实验旨在实现一种基于 Python 的图像水印嵌入与提取方法，验证其在不同图像处理操作下的鲁棒性。通过嵌入文字水印、提取水印以及对水印图像进行一系列变换，评估水印的嵌入效果和提取的准确性。

## 二、实验环境

- **操作系统**：Windows 10
- **编程语言**：Python 3.9
- **依赖库**：Pillow、NumPy、OpenCV
- **硬件**：Intel Core i5-10210U、8GB RAM

## 三、实验内容

### 1. 水印嵌入

使用 Pillow 库将文字水印绘制到图像的右下角，采用较大的字体以确保水印的可见性。通过 `ImageDraw` 和 `ImageFont` 模块实现水印的绘制，并将水印图层与原图进行透明度合成，生成带有水印的图像。

### 2. 水印提取

通过 OpenCV 库对比原图与水印图的差异，提取水印区域。首先计算两幅图像的绝对差值，然后将差值图像转换为灰度图并进行二值化处理，最终得到水印的掩码图像。

### 3. 鲁棒性测试

对带有水印的图像进行一系列变换，包括翻转、平移、裁剪和调节对比度，以测试水印在这些操作下的鲁棒性。使用 Pillow 和 OpenCV 库实现这些变换，并保存变换后的图像。

## 四、实验结果

| 测试项目    | 原始图像路径           | 处理后图像路径                  | 备注     |
| ------- | ---------------- | ------------------------ | ------ |
| 原始图像    | a.png            | -                        | -      |
| 嵌入水印    | a.png            | watermarked.jpeg         | 水印嵌入成功 |
| 提取水印    | watermarked.jpeg | extracted_watermark.jpeg | 水印提取成功 |
| 翻转测试    | watermarked.jpeg | test_flipped.jpg         | 水印依然可辨 |
| 平移测试    | watermarked.jpeg | test_shifted.jpg         | 水印依然可辨 |
| 裁剪测试    | watermarked.jpeg | test_cropped.jpg         | 水印部分丢失 |
| 对比度调节测试 | watermarked.jpeg | test_contrasted.jpg      | 水印依然可辨 |

> 从实验结果可以看出，嵌入的水印在翻转、平移和对比度调节操作下依然能够被清晰地提取出来，但在裁剪操作中，水印的部分区域可能会丢失。这说明水印在一定程度上具有鲁棒性，但在极端情况下可能会受到影响。

## 五、收获与感悟

1. **图像处理的多样性**：通过本次实验，我们了解到图像处理不仅包括简单的滤波和变换，还可以用于嵌入和提取隐藏信息，如水印。
2. **鲁棒性的重要性**：在实际应用中，水印需要在多种图像处理操作下保持稳定。虽然本次实验的水印在部分操作下表现出较好的鲁棒性，但在裁剪等极端情况下仍需进一步改进。
3. **Python 的强大功能**：Pillow 和 OpenCV 库为图像处理提供了强大的支持，使得复杂的图像操作变得简单易行。通过组合这些库的功能，可以实现丰富的图像处理应用。
4. **实验的改进方向**：未来可以尝试使用更复杂的水印嵌入算法，如基于频域的水印嵌入，以提高水印的鲁棒性和不可见性。

> **总结**：本次实验成功实现了图像水印的嵌入与提取，并对其鲁棒性进行了初步测试。虽然在某些情况下水印的鲁棒性还有待提高，但实验结果已经证明了该方法的有效性。未来可以进一步优化算法，以应对更复杂的图像处理场景。
